<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trincomalee District Disaster Response Dashboard</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Load Poppins Font for a professional look -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Custom Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rdhs-blue': '#1a56db', // Stronger Blue
                        'accent-primary': '#10b981', // Green for main accent/data success
                        'accent-secondary': '#f97316', // Orange for urgency
                        'bg-light': '#f3f4f6', // Lighter background
                        'card-bg': '#ffffff',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Poppins', 'sans-serif'], // Poppins for main title
                    },
                    boxShadow: {
                        'custom': '0 10px 30px -5px rgba(26, 86, 219, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom styles for the table for better mobile UX */
        .responsive-table th, .responsive-table td {
            padding: 14px 20px;
            text-align: left;
        }
        .responsive-table th {
            letter-spacing: 0.05em;
        }

        /* Ensure icon rendering */
        [lucide] {
            stroke-width: 2.5;
        }
        
        /* Highlighting for selected MOH filter */
        #moh-filter-container button {
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
            /* Professional shadow effect for all buttons */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        #moh-filter-container button.selected {
            background-color: var(--tw-colors-rdhs-blue);
            color: white;
            box-shadow: 0 4px 10px rgba(26, 86, 219, 0.4);
            transform: translateY(-2px) scale(1.02);
            border-color: white;
        }

    </style>
</head>
<body class="bg-bg-light font-sans min-h-screen">

    <div id="dashboard-app" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Header and Banner - Centered, Larger Font -->
        <header class="mb-10 p-6 bg-rdhs-blue text-white rounded-xl shadow-custom shadow-rdhs-blue/40 text-center">
            <div class="space-y-2">
                <h1 class="text-5xl md:text-6xl font-heading font-extrabold tracking-tighter">
                    Trincomalee Disaster Response
                </h1>
                <p class="text-xl font-light opacity-90">
                    Real-time Welfare Camp Status for RDHS
                </p>
                <!-- INCREASED SIZE AND FONT FOR RDHS SUBHEADING -->
                <div class="pt-4">
                    <p class="text-xl md:text-2xl font-heading font-semibold text-yellow-300">Office of Regional Director of Health Services (RDHS)</p>
                    <p class="text-sm">Health Information Management Unit</p>
                </div>
            </div>
        </header>

        <!-- Status Bar -->
        <div id="status-bar" class="mb-8 p-4 bg-red-50 text-red-800 border-l-4 border-red-500 rounded-lg shadow-md flex items-center justify-between">
            <div class="flex items-center">
                <i lucide="alert-triangle" class="w-6 h-6 mr-3 flex-shrink-0 text-red-600"></i>
                <span class="text-sm md:text-base font-bold uppercase tracking-wide">
                    URGENT: OFFICIAL DATA CONFIRMATION REQUIRED
                </span>
            </div>
            <p id="data-update-time" class="text-sm font-medium text-red-600 flex items-center">
                <i lucide="clock" class="w-4 h-4 inline mr-1"></i>
                Data Last Updated: <strong>Loading...</strong>
            </p>
        </div>
 <div class="flex justify-center my-10">
    <a href="HighRisk.html" 
       class="
            bg-red-600 
            hover:bg-red-700 
            text-white 
            font-extrabold 
            py-5 
            px-12 
            text-xl 
            rounded-full 
            shadow-2xl 
            transition 
            duration-500 
            flex 
            items-center 
            gap-3
            uppercase
            tracking-wider
            hero-pulse-button">
        
        <svg class="h-8 w-8 text-yellow-300 animate-bounce" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.305 3.25 1.953 3.25h14.706c1.648 0 2.813-1.75 1.948-3.25L12 2.25 2.997 16.126zM12 15.75h.007v.008H12v-.008z" />
        </svg>
        
        <span class="z-10">View Critical High-Risk Dashboard</span>
    </a>
</div>
        <!-- Summary Cards Section -->
        <h2 class="text-3xl font-bold mb-6 text-accent-primary border-b-2 border-accent-primary/50 pb-2 flex items-center">
            <i lucide="layout-dashboard" class="w-6 h-6 mr-3 text-accent-primary"></i>
            Current Situation Overview
        </h2>
        <div id="summary-cards" class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
            <!-- Cards will be populated here by JavaScript -->
        </div>
        
        <!-- Interactive Visualization (MOH Filter) Section -->
        <h2 class="text-3xl font-bold mb-6 mt-8 text-accent-secondary border-b-2 border-accent-secondary/50 pb-2 flex items-center">
            <i lucide="filter" class="w-6 h-6 mr-3 text-accent-secondary"></i>
            Filter Camp Data by MOH Area
        </h2>
        <div class="bg-card-bg p-6 rounded-xl shadow-custom border border-gray-100 mb-8">
            <p class="text-lg font-medium mb-4 text-gray-700">Select an MOH Area to view camp details:</p>
            <div id="moh-filter-container" class="flex flex-wrap gap-3">
                <!-- MOH Filter Buttons will be populated here -->
            </div>
        </div>

        <!-- Camp Data Table Section - Enhanced Styling -->
        <div class="bg-card-bg p-6 rounded-xl shadow-custom border border-gray-100">
            <h2 class="text-xl font-bold mb-4 text-gray-800 flex items-center">
                <i lucide="list-checks" class="w-6 h-6 mr-2 text-rdhs-blue"></i>
                Detailed Welfare Camp Data <span id="current-moh-filter" class="ml-3 text-sm font-medium text-gray-500">(Showing All Camps)</span>
            </h2>
            <div class="overflow-x-auto">
                <table id="camp-data-table" class="min-w-full responsive-table bg-white rounded-lg">
                    <thead class="bg-rdhs-blue/10 border-b-2 border-rdhs-blue/20">
                        <tr>
                            <th class="text-sm font-bold tracking-wider text-rdhs-blue uppercase">Center Name</th>
                            <th class="text-sm font-bold tracking-wider text-rdhs-blue uppercase">MOH Area</th>
                            <th class="text-sm font-bold tracking-wider text-gray-700 uppercase">Families</th>
                            <th class="text-sm font-bold tracking-wider text-gray-700 uppercase">People</th>
                            <th class="text-sm font-bold tracking-wider text-accent-primary uppercase">Infants</th>
                            <th class="text-sm font-bold tracking-wider text-accent-primary uppercase">Under 5Y</th>
                            <th class="text-sm font-bold tracking-wider text-accent-primary uppercase">Pregnant</th>
                        </tr>
                    </thead>
                    <tbody id="camp-data-body">
                        <!-- Table rows will be populated here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Footer and Contact Info - REDESIGNED WITH CARD BACKGROUND -->
        <footer class="mt-12">
            <div class="bg-card-bg p-6 rounded-xl shadow-custom border border-gray-100 text-center text-gray-600">
                
                <!-- Disclaimer Section -->
                <div class="mb-6 pb-4 border-b border-gray-200">
                    <p class="text-lg font-semibold text-gray-800 mb-2">
                        <i lucide="briefcase" class="w-5 h-5 inline mr-2 text-accent-secondary"></i>
                        Official Use Disclaimer
                    </p>
                    <p class="text-sm font-medium mb-3">
                        This dashboard is a <span class="text-accent-secondary font-bold">temporary field tool</span> to help health workers quickly understand the ground situation.
                    </p>
                    <p class="text-sm">
                        For <span class="font-bold text-rdhs-blue">official use or distribution</span>, you must obtain formal confirmation from the <span class="font-bold">RDHS office</span> via the contact details below.
                    </p>
                </div>

                <!-- Contact Info Section - Differentiated -->
                <div class="bg-rdhs-blue/5 p-4 rounded-lg border border-rdhs-blue/20 mb-6">
                    <p class="text-md font-bold text-rdhs-blue mb-3 uppercase tracking-wider">RDHS Contact Information</p>
                    <div class="flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-8 text-sm">
                        <p class="flex items-center justify-center font-medium text-gray-700">
                            <i lucide="map-pin" class="w-4 h-4 mr-1 text-rdhs-blue flex-shrink-0"></i>
                            120 Court Rd, Trincomalee
                        </p>
                        <p class="flex items-center justify-center font-medium text-gray-700">
                            <i lucide="phone" class="w-4 h-4 mr-1 text-rdhs-blue flex-shrink-0"></i>
                            026 2222263
                        </p>
                        <p class="flex items-center justify-center font-medium text-gray-700">
                            <i lucide="mail" class="w-4 h-4 mr-1 text-rdhs-blue flex-shrink-0"></i>
                            trincomoinfo@gmail.com
                        </p>
                    </div>
                </div>

                <!-- Copyright -->
                <p class="mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500">
                    Â© 2025 Trincomalee RDHS Health Information Management Unit. All Rights Reserved.
                </p>
            </div>
        </footer>

    </div>

    <script>
        // Data Structure based on uploaded files and MOH areas
        const RAW_CAMP_DATA = [
            { name: "Al Hithaya M.V", moh: "Mutur", families: 97, people: 411, male: 204, female: 207, infants: 0, under5: 47, pregnant: 2, deaths: 0, missing: 0 },
            { name: "Asraf Vidiyalayam", moh: "Mutur", families: 7, people: 33, male: 13, female: 20, infants: 0, under5: 4, pregnant: 0, deaths: 0, missing: 0 },
            { name: "Al Hilal C.C", moh: "Mutur", families: 46, people: 142, male: 64, female: 78, infants: 0, under5: 0, pregnant: 0, deaths: 0, missing: 0 },
            { name: "Vipulanantha Vidiyalayam", moh: "Mutur", families: 43, people: 112, male: 49, female: 63, infants: 0, under5: 46, pregnant: 2, deaths: 0, missing: 0 },
            { name: "Amman Nagar Ambal Vid", moh: "Mutur", families: 35, people: 85, male: 40, female: 45, infants: 0, under5: 12, pregnant: 1, deaths: 0, missing: 0 },
            { name: "Aysha Vidiyalayam", moh: "Mutur", families: 9, people: 28, male: 12, female: 16, infants: 0, under5: 7, pregnant: 0, deaths: 0, missing: 0 },
            { name: "Muthur Muslim Ladies College", moh: "Mutur", families: 245, people: 909, male: 444, female: 465, infants: 0, under5: 55, pregnant: 3, deaths: 0, missing: 0 }
        ];

        // All potential MOH areas in the district
        const ALL_MOH_AREAS = [
            "Padavisripura", "Gomarankadawala", "Kuchchaveli", "Trincomalee",
            "Thampalagamam", "Kinniya", "Eachchalampathu", "Seruwila",
            "Kanthale", "Uppuveli", "Kurinchakerny", "Mutur"
        ];
        
        let currentMOHFilter = null; // State to track the active filter

        // --- Helper Functions ---

        /**
         * Calculates the total statistics from the raw data.
         * @param {Array} data - The dataset to calculate totals from.
         * @returns {object} Total statistics.
         */
        function calculateTotals(data) {
            const totals = {
                totalCamps: data.length,
                totalPeople: 0,
                totalFamilies: 0,
                totalInfants: 0,
                totalUnder5: 0,
                totalPregnant: 0,
                totalDeaths: 0,
                totalMissing: 0,
            };

            data.forEach(camp => {
                totals.totalPeople += camp.people;
                totals.totalFamilies += camp.families;
                totals.totalInfants += camp.infants;
                totals.totalUnder5 += camp.under5;
                totals.totalPregnant += camp.pregnant;
                totals.totalDeaths += camp.deaths;
                totals.totalMissing += camp.missing;
            });

            return totals;
        }

        /**
         * Creates an HTML string for a single summary card.
         */
        function createSummaryCard(title, value, iconName, colorClass) {
            return `
                <div class="bg-card-bg p-5 rounded-xl shadow-custom border-b-4 ${colorClass} hover:shadow-2xl transition duration-300 transform hover:scale-[1.02] cursor-default">
                    <div class="flex items-center justify-between">
                        <div class="p-3 ${colorClass}/20 rounded-full">
                            <i lucide="${iconName}" class="w-6 h-6 ${colorClass}"></i>
                        </div>
                        <span class="text-3xl sm:text-4xl font-extrabold text-gray-900">${value.toLocaleString()}</span>
                    </div>
                    <p class="mt-4 text-xs sm:text-sm font-semibold text-gray-500 uppercase tracking-wider">${title}</p>
                </div>
            `;
        }

        /**
         * Renders the summary cards and updates the DOM based on the filtered data.
         * If currentMOHFilter is set, it shows totals for that area. Otherwise, it shows global totals.
         */
        function renderSummaryCards() {
            const dataToDisplay = currentMOHFilter 
                ? RAW_CAMP_DATA.filter(c => c.moh === currentMOHFilter)
                : RAW_CAMP_DATA;

            const totals = calculateTotals(dataToDisplay);
            const cardsContainer = document.getElementById('summary-cards');
            
            const cardData = [
                { title: "Total People Displaced", value: totals.totalPeople, icon: "users", color: "border-rdhs-blue text-rdhs-blue" },
                { title: "Total Active Camps", value: totals.totalCamps, icon: "tent", color: "border-accent-secondary text-accent-secondary" },
                { title: "Families Sheltered", value: totals.totalFamilies, icon: "home", color: "border-accent-primary text-accent-primary" },
                { title: "Vulnerable Individuals", value: totals.totalInfants + totals.totalUnder5 + totals.totalPregnant, icon: "shield-alert", color: "border-red-600 text-red-600" },
            ];

            cardsContainer.innerHTML = cardData.map(d => createSummaryCard(d.title, d.value, d.icon, d.color)).join('');
            
            lucide.createIcons();
        }

        /**
         * Renders the detailed camp data table based on the active filter.
         */
        function renderCampTable() {
            const tableBody = document.getElementById('camp-data-body');
            const filterText = document.getElementById('current-moh-filter');
            
            const filteredData = currentMOHFilter
                ? RAW_CAMP_DATA.filter(c => c.moh === currentMOHFilter)
                : RAW_CAMP_DATA;

            // Update the filter status text
            filterText.textContent = currentMOHFilter 
                ? `(Showing Camps in ${currentMOHFilter})` 
                : `(Showing All ${RAW_CAMP_DATA.length} Camps)`;

            if (filteredData.length === 0 && currentMOHFilter) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center p-6 text-lg text-gray-500 bg-gray-50">
                            No active camps reported in the ${currentMOHFilter} MOH Area at this time.
                        </td>
                    </tr>
                `;
                return;
            }

            const rows = filteredData.map(camp => `
                <tr class="border-b last:border-b-0 hover:bg-rdhs-blue/5 transition duration-150">
                    <td class="whitespace-nowrap font-medium text-gray-900">${camp.name}</td>
                    <td class="text-gray-600 font-semibold">${camp.moh}</td>
                    <td class="text-gray-800">${camp.families}</td>
                    <td class="text-gray-800 font-bold">${camp.people}</td>
                    <td class="text-accent-primary font-bold text-center">${camp.infants}</td>
                    <td class="text-accent-primary font-bold text-center">${camp.under5}</td>
                    <td class="text-accent-primary font-bold text-center">${camp.pregnant}</td>
                </tr>
            `).join('');

            tableBody.innerHTML = rows;
        }
        
        /**
         * Renders the interactive MOH filter buttons.
         */
        function renderMOHFilters() {
            const container = document.getElementById('moh-filter-container');
            container.innerHTML = ''; // Clear existing buttons
            const uniqueMohs = [...new Set(RAW_CAMP_DATA.map(c => c.moh))];
            
            // MOH areas with active camps
            const activeMohs = uniqueMohs.filter(moh => RAW_CAMP_DATA.some(c => c.moh === moh));

            // Create 'Show All' button
            const allButton = document.createElement('button');
            allButton.textContent = 'Show All Camps';
            allButton.className = `px-5 py-2.5 rounded-xl font-bold transition duration-150 shadow-lg hover:shadow-xl ${currentMOHFilter === null ? 'selected' : 'bg-rdhs-blue/10 text-rdhs-blue hover:bg-rdhs-blue/20'}`;
            allButton.onclick = () => filterData(null, allButton);
            container.appendChild(allButton);
            
            // Create buttons for active MOH areas
            activeMohs.forEach(moh => {
                const button = document.createElement('button');
                button.textContent = moh;
                button.className = `px-5 py-2.5 rounded-xl font-bold transition duration-150 shadow-lg hover:shadow-xl ${currentMOHFilter === moh ? 'selected' : 'bg-rdhs-blue/10 text-rdhs-blue hover:bg-rdhs-blue/20'}`;
                button.onclick = () => filterData(moh, button);
                container.appendChild(button);
            });
            
            // Add inactive MOH areas for completeness (can be helpful if a new camp opens)
            const inactiveMohs = ALL_MOH_AREAS.filter(moh => !activeMohs.includes(moh));
            inactiveMohs.forEach(moh => {
                const button = document.createElement('button');
                button.textContent = `${moh} (No Camps)`;
                button.className = 'px-5 py-2.5 rounded-xl font-medium transition duration-150 bg-gray-100 text-gray-400 cursor-not-allowed shadow-md';
                button.disabled = true;
                container.appendChild(button);
            });
        }
        
        /**
         * Filters the dashboard data based on the selected MOH area.
         */
        function filterData(mohArea, clickedButton) {
            currentMOHFilter = mohArea;
            
            // Update button styles and re-render the filter container
            document.querySelectorAll('#moh-filter-container button').forEach(btn => {
                // Determine if this button represents the currently active filter
                const isSelected = (mohArea === null && btn.textContent === 'Show All Camps') || (mohArea !== null && btn.textContent === mohArea);

                // Reset classes
                btn.classList.remove('selected', 'bg-rdhs-blue', 'text-white', 'bg-rdhs-blue/10', 'hover:bg-rdhs-blue/20');
                
                if (btn.disabled) {
                    btn.classList.add('bg-gray-100', 'text-gray-400', 'cursor-not-allowed', 'shadow-md');
                    return;
                }

                if (isSelected) {
                    // Apply selected style
                    btn.classList.add('selected');
                } else {
                    // Apply unselected style (Show All gets a neutral background, MOHs get the accent color)
                    if (btn.textContent === 'Show All Camps') {
                        btn.classList.add('bg-rdhs-blue/10', 'text-rdhs-blue', 'hover:bg-rdhs-blue/20');
                    } else {
                        btn.classList.add('bg-rdhs-blue/10', 'text-rdhs-blue', 'hover:bg-rdhs-blue/20');
                    }
                }
            });

            // Re-render dashboard sections with filtered data
            renderSummaryCards();
            renderCampTable();
        }


        // --- Initialization ---

        function initDashboard() {
            // 1. Update the last updated time
            document.getElementById('data-update-time').innerHTML = '<i lucide="clock" class="w-4 h-4 inline mr-1"></i> Data Last Updated: <strong>December 5th, 2025, 1:00 PM</strong>';
            
            // 2. Render all components
            renderMOHFilters(); // Renders interactive filter buttons
            renderSummaryCards(); // Renders totals (initially for all)
            renderCampTable(); // Renders the table (initially for all)
            
            // Re-render Lucide icons
            lucide.createIcons(); 
        }

        // Run the initialization function when the window loads
        window.onload = initDashboard;
    </script>
</body>
</html>
